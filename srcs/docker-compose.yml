services:

    nginx:
      container_name: nginx
      build: ./nginx
      ports:
        - "8443:443"        # Point d'entr√©e HTTPS public
      depends_on:
        - gateway
        - front
      networks:
        - transcendence

    gateway:
      container_name: gateway
      build: ./back/gateway
      expose:
        - "8080"            # Port interne uniquement, accessible depuis nginx  
      depends_on:
        - auth
        - user
        - game
        - chat
      env_file: 
        - .env
      networks: 
        - transcendence 

    front:
      container_name: front
      build: ./front
      expose:
        - "80"
      depends_on:
        - gateway
      networks: 
        - transcendence

    auth:
      container_name: auth
      build: ./back/auth
      expose:
        - "3001"
      env_file: 
        - .env
      networks: 
        - transcendence
      volumes:
        - ./back/game/data:/app/auth/data

    chat:
      container_name: chat
      build: ./back/chat
      expose:
        - "3002"
      env_file: 
        - .env
      networks: 
        - transcendence
      volumes:
        - ./back/chat/data:/app/chat/data

    game:
      container_name: game
      build: ./back/game
      expose:
        - "3003"
      env_file: 
        - .env
      networks:
        - transcendence
      volumes:
        - ./back/game/data:/app/game/data

    user:
      container_name: user
      build: ./back/user
      expose:
        - "3004"
      env_file: 
        - .env
      networks: 
        - transcendence
      volumes:
        - ./back/user/data:/app/user/data

    
networks:
  transcendence:
    name: transcendence
    driver: bridge